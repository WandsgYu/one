<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGB & Profit</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background: #1e1e2f;
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
        }

        .value {
            font-size: 100px;
            font-weight: bold;
            margin: 10px 0;
        }

        .label {
            font-size: 20px;
            color: #87ceeb;
        }
    </style>
</head>

<body>
    <div>
        <div class="value" id="bgbPrice">$0.00</div>
    </div>
    <div>
        <div class="value" id="totalProfitCny">0</div>
    </div>

    <script>
        const exchangeRate = 7.22; // Updated USD to CNY exchange rate
        const additionalUsd = 310; // Additional USD to be added to total profit
        const updateInterval = 500; // ms
        const apiUrlBase = "https://api.bitget.com/api/mix/v1/market/ticker?symbol=";

        // Position data for profit calculations
        const positions = [
            { symbol: "BGB", quantity: 276, openPrice: 7.337, isShort: false }
        ];

        // Fetch price for a specific symbol
        async function fetchPrice(symbol) {
            try {
                const response = await fetch(`${apiUrlBase}${symbol}USDT_UMCBL`);
                const data = await response.json();
                return parseFloat(data.data.last);
            } catch (error) {
                console.error(`Error fetching price for ${symbol}:`, error);
                return null;
            }
        }

        // Update BGB price, calculate total profit, and display final value
        async function updateData() {
            // Fetch BGB price
            const bgbPrice = await fetchPrice("BGB");
            if (bgbPrice !== null) {
                document.getElementById("bgbPrice").textContent = `${bgbPrice.toFixed(3)}`;
            }

            // Calculate total profit in USD
            let totalProfitUsd = 0;

            for (const position of positions) {
                const currentPrice = await fetchPrice(position.symbol);
                if (currentPrice !== null) {
                    const priceDifference = position.isShort
                        ? position.openPrice - currentPrice
                        : currentPrice - position.openPrice;
                    const profit = priceDifference * Math.abs(position.quantity);
                    totalProfitUsd += profit;
                }
            }

            // Add fixed additional profit
            totalProfitUsd += additionalUsd;

            // Convert total profit to CNY
            const totalProfitCny = totalProfitUsd * exchangeRate;

            // Update total profit display
            document.getElementById("totalProfitCny").textContent = `${Math.floor(totalProfitCny)}`;

            // Update page title with final total value
            document.title = `${bgbPrice.toFixed(3)} ${Math.floor(totalProfitCny)}`;
        }

        // Update data at the defined interval
        setInterval(updateData, updateInterval);

        // Initial load
        updateData();
    </script>
</body>

</html>
